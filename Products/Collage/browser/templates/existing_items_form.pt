<div xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
     xmlns:tal="http://xml.zope.org/namespaces/tal"
     xmlns:metal="http://xml.zope.org/namespaces/metal"
     i18n:domain="collage"
     tal:omit-tag="">

  <form class="collage-existing-items"
	tal:define="filter_portal_type request/portal_type|nothing"
	tal:attributes="action string:${here/absolute_url}/existing-items-form">
    <div class="field">
      <label i18n:translate="label_content_type"
	     for="portal_type">Content type</label><br />
      <select name="portal_type"
	      tal:define="allowedTypes here/getAllowedTypes">
	<option i18n:translate="label_all_content_types"
		value="">All</option>
	<option tal:repeat="ctype allowedTypes"
		i18n:domain="plone"
		i18n:translate=""
		tal:attributes="value ctype/getId;
				selected python: filter_portal_type == ctype.getId() and 'selected'"
		tal:content="ctype/Title">Type-name</option>
      </select>
    </div>
    
    <div class="insert-existing-items">
      <div tal:repeat="item view/getItems">
	<h4 tal:attributes="class string:visualIcon contenttype-${item/portal_type}">
	  <span class="title visualIconPadding">
	    <a href="#"
	       tal:attributes="href string:${here/absolute_url}/insert-alias?uid=${item/UID}">
	      <tal:title content="item/title">Title</tal:title>
	      <img tal:attributes="src string:${view/portal_url}/icon-insert.gif" alt="Insert" />
	    </a>
	  </span>
	</h4>
	
	<p tal:content="item/description" />
	
	<p class="discreet">
	  <tal:modified replace="item/modified" />
	  (<tal:type replace="item/portal_type" />)
	</p>
	
      </div>  
    </div>
  </form>

</div>
